{
  "$schema": "https://json.schemastore.org/claude-code-settings.json",
  "description": "Hooks 配置範本 - 來自 everything-claude-code (MIT License)",
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "tool == \"Edit\" && tool_input.file_path matches \"\\\\.(ts|tsx|js|jsx)$\"",
        "hooks": [
          {
            "type": "command",
            "command": "#!/bin/bash\n# 編輯 JS/TS 檔案前提醒\ninput=$(cat)\nfile_path=$(echo \"$input\" | jq -r '.tool_input.file_path // \"\"')\necho \"[Hook] 編輯: $file_path\" >&2\necho \"$input\""
          }
        ],
        "description": "編輯 JS/TS 檔案前提醒"
      },
      {
        "matcher": "tool == \"Bash\" && tool_input.command matches \"git push\"",
        "hooks": [
          {
            "type": "command",
            "command": "#!/bin/bash\necho '[Hook] 準備 push 前請確認變更...' >&2\necho '[Hook] 建議執行: git diff --stat' >&2\ninput=$(cat)\necho \"$input\""
          }
        ],
        "description": "Git push 前提醒審查變更"
      }
    ],
    "PostToolUse": [
      {
        "matcher": "tool == \"Edit\" && tool_input.file_path matches \"\\\\.(ts|tsx|js|jsx)$\"",
        "hooks": [
          {
            "type": "command",
            "command": "#!/bin/bash\n# 編輯後檢查 console.log\ninput=$(cat)\nfile_path=$(echo \"$input\" | jq -r '.tool_input.file_path // \"\"')\n\nif [ -n \"$file_path\" ] && [ -f \"$file_path\" ]; then\n  console_logs=$(grep -n \"console\\\\.log\" \"$file_path\" 2>/dev/null || true)\n  \n  if [ -n \"$console_logs\" ]; then\n    echo \"[Hook] 警告: $file_path 中發現 console.log\" >&2\n    echo \"$console_logs\" | head -5 >&2\n    echo \"[Hook] 提交前請移除 console.log\" >&2\n  fi\nfi\n\necho \"$input\""
          }
        ],
        "description": "編輯後警告 console.log"
      },
      {
        "matcher": "tool == \"Bash\"",
        "hooks": [
          {
            "type": "command",
            "command": "#!/bin/bash\n# 偵測 PR 建立並記錄\ninput=$(cat)\ncmd=$(echo \"$input\" | jq -r '.tool_input.command')\n\nif echo \"$cmd\" | grep -qE 'gh pr create'; then\n  output=$(echo \"$input\" | jq -r '.tool_output.output // \"\"')\n  pr_url=$(echo \"$output\" | grep -oE 'https://github.com/[^/]+/[^/]+/pull/[0-9]+')\n  \n  if [ -n \"$pr_url\" ]; then\n    echo \"[Hook] PR 已建立: $pr_url\" >&2\n  fi\nfi\n\necho \"$input\""
          }
        ],
        "description": "PR 建立後記錄 URL"
      }
    ],
    "SessionStart": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "~/.claude/hooks/session-start.sh"
          }
        ],
        "description": "載入先前工作階段上下文"
      }
    ],
    "Stop": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "#!/bin/bash\n# 最終 console.log 審計\ninput=$(cat)\n\nif git rev-parse --git-dir > /dev/null 2>&1; then\n  modified_files=$(git diff --name-only HEAD 2>/dev/null | grep -E '\\.(ts|tsx|js|jsx)$' || true)\n  \n  if [ -n \"$modified_files\" ]; then\n    has_console=false\n    while IFS= read -r file; do\n      if [ -f \"$file\" ]; then\n        if grep -q \"console\\.log\" \"$file\" 2>/dev/null; then\n          echo \"[Hook] 警告: $file 中發現 console.log\" >&2\n          has_console=true\n        fi\n      fi\n    done <<< \"$modified_files\"\n    \n    if [ \"$has_console\" = true ]; then\n      echo \"[Hook] 提交前請移除 console.log\" >&2\n    fi\n  fi\nfi\n\necho \"$input\""
          }
        ],
        "description": "工作階段結束時最終審計"
      },
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "~/.claude/hooks/session-end.sh"
          }
        ],
        "description": "保存工作階段狀態"
      }
    ],
    "PreCompact": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "~/.claude/hooks/pre-compact.sh"
          }
        ],
        "description": "壓縮前保存狀態"
      }
    ]
  }
}
